<!DOCTYPE html>
<html lang="en"
	  xmlns:th="http://www.thymeleaf.org"
	  xmlns="http://www.w3.org/1999/xhtml"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head th:replace = "~{fragments/page-header :: header('新規登録')}">
</head>

<body class="animsition">

	<!-- Header -->
	<head th:replace="~{fragments/nav-header :: nav-header}">


	<!-- Title page -->
	<section class="bg-img1 txt-center p-lr-15 p-tb-92" style="background-image: url('images/bg-01.jpg');">
		<h2 class="ltext-105 cl0 txt-center">
			新規登録
		</h2>
	</section>

	<!-- Content page -->
	<section class="bg0 p-t-104 p-b-116">
		<div class="container">
			<div class="flex-w flex-c">
				<div class="size-210 bor10 p-lr-70 p-t-55 p-b-70 p-lr-15-lg w-full-md">
					<form th:action="@{/register}" th:object="${customer}" th:method="POST">
						<h4 class="mtext-105 cl2 txt-center p-b-30">
							新規登録
						</h4>
						<!-- エラーメッセージ表示-->
						<b id = "emailError_msg"></b>
						<!-- エラーメッセージ表示-->
						<div class="flex-w flex-m m-b-10 p-b-13">
							<div class="size-203">
								<span class="stext-110 cl2">
									E-Mail
								</span>
							</div>

							<div class="size-204">
								<input type="text" id="email" name="email" th:field="*{email}" class="stext-111 cl2 plh3 size-111 bor10 p-l-10" oninput="nullCheck(); reInputEmail();">
							</div>
						</div>
						<div class="flex-w flex-m m-b-10 p-b-13">
							<div class="size-203">
								<span class="stext-110 cl2">
									パスワード
								</span>
							</div>

							<div class="size-204">
								<input type="password" id="password" name="password" th:field="*{password}" class="stext-111 cl2 plh3 size-111 bor10 p-l-10" oninput="confirmPassword(); nullCheck();">
							</div>
						</div>
						<!-- エラーメッセージ表示-->
						<b id = "passwordError_msg"></b>
						<!-- エラーメッセージ表示-->
						<div class="flex-w flex-m m-b-10 p-b-13 ">
							<div class="size-203">
								<b id="error_msg"></b>
								<span class="stext-110 cl2">
									確認パスワード
								</span>
							</div>

							<div class="size-204">
								<input type="password" id="rePassword" name="rePassword" class="stext-111 cl2 plh3 size-111 bor10 p-l-10" oninput="confirmPassword(); nullCheck();">
							</div>
						</div>
						<div class="flex-w flex-m m-b-10 p-b-13">
							<div class="size-203">
								<span class="stext-110 cl2">
									性
								</span>
							</div>

							<div class="size-204">
								<input type="text" id="firstName" th:field="*{firstName}" class="stext-111 cl2 plh3 size-111 bor10 p-l-10" placeholder="フリガナ" oninput="nullCheck()">
							</div>
						</div>
						<div class="flex-w flex-m m-b-10 p-b-13">
							<div class="size-203">
								<span class="stext-110 cl2">
									名
								</span>
							</div>

							<div class="size-204">
								<input type="text" id="lastName" th:field="*{lastName}" class="stext-111 cl2 plh3 size-111 bor10 p-l-10" placeholder="フリガナ" oninput="nullCheck()">	
							</div>
						</div>
						<div class="flex-w flex-m m-b-10 p-b-13">
							<div class="size-203">
								<span class="stext-110 cl2">
									性別
								</span>
							</div>

							<div class="size-204">
								<div class="flex-w flex-sa-m">
									<span class="flex-w">
										<input type="radio" id="gender" name="gender" class="stext-111 p-lr-10" value="1">男性
									</span>
									<span class="flex-w">
										<input type="radio" id="gender" name="gender" class="stext-111" value = "2">女性
									</span>
								</div>

							</div>
						</div>
						<div class="flex-w flex-m m-b-10 p-b-13">
							<div class="size-203">
								<span class="stext-110 cl2">
									電話番号
								</span>
							</div>

							<div class="size-204">
								<input type="text" id="phoneNumber" th:field="*{phoneNumber}" class="stext-111 cl2 plh3 size-111 bor10 p-l-10" placeholder="000-0000-0000" oninput="nullCheck()">	
							</div>
						</div>
						<div class="flex-w flex-m m-b-10 p-b-13">
							<div class="size-203">
								<span class="stext-110 cl2">
									郵便番号
								</span>
							</div>

							<div class="size-204">
								<input type="text" id="postCode" name="postCode" class="stext-111 cl2 plh3 size-111 bor10 p-l-10" placeholder="123-4567" oninput="nullCheck()">	
							</div>
						</div>
						<div class="flex-w flex-m m-b-10 p-b-13">
							<div class="size-203">
								<span class="stext-110 cl2">
									住所
								</span>
							</div>

							<div class="size-204">
								<input type="text" id="firstAddress" name="firstAddress" class="stext-111 cl2 plh3 size-111 bor10 p-l-10" placeholder="市区町" oninput="nullCheck()">
							</div>
						</div>
						<div class="flex-w flex-m m-b-10 p-b-13">
							<div class="size-203">
								<span class="stext-110 cl2">
									住所
								</span>
							</div>

							<div class="size-204">
								<input type="text" id="lastAddress" name="lastAddress" class="stext-111 cl2 plh3 size-111 bor10 p-l-10" placeholder="番地,マンション名" oninput="nullCheck()">	
							</div>
						</div>
						<button id="button_" disabled class="flex-c-m stext-101 cl0 size-121 bg3 bor1 hov-btn3 p-lr-15 trans-04 pointer m-t-50">登録</button>
					</form>
				</div>
			</div>
		</div>
	</section>
	
	<!-- email自動送信用フォーム 
	<form name="emailCheckForm" id="emailCheckForm" th:action="@{/checkAcc}" th:method="GET">
		<input type="hidden" id="sendEmail" name="sendEmail">
	</form>-->
	
	<!-- Map -->


	<!-- Footer -->
	<footer class="bg3 p-t-75 p-b-32">
		<div class="container">
			<div class="row">
				<div class="col-sm-6 col-lg-3 p-b-50">
					<h4 class="stext-301 cl0 p-b-30">
						カテゴリー
					</h4>

					<ul>
						<li class="p-b-10">
							<a href="#" class="stext-107 cl7 hov-cl1 trans-04">
								adidas
							</a>
						</li>

						<li class="p-b-10">
							<a href="#" class="stext-107 cl7 hov-cl1 trans-04">
								jordan
							</a>
						</li>

						<li class="p-b-10">
							<a href="#" class="stext-107 cl7 hov-cl1 trans-04">
								NewBlance
							</a>
						</li>

						<li class="p-b-10">
							<a href="#" class="stext-107 cl7 hov-cl1 trans-04">
								NIKE
							</a>
						</li>
					</ul>
				</div>

				<div class="col-sm-6 col-lg-3 p-b-50">
					<h4 class="stext-301 cl0 p-b-30">
						お問い合わせ
					</h4>

					<ul>
						<li class="p-b-10">
							<a href="#" class="stext-107 cl7 hov-cl1 trans-04">
								注文
							</a>
						</li>

						<li class="p-b-10">
							<a href="#" class="stext-107 cl7 hov-cl1 trans-04">
								キャンセル
							</a>
						</li>

						<li class="p-b-10">
							<a href="#" class="stext-107 cl7 hov-cl1 trans-04">
								運送
							</a>
						</li>

						<li class="p-b-10">
							<a href="#" class="stext-107 cl7 hov-cl1 trans-04">
								FAQs
							</a>
						</li>
					</ul>
				</div>

				<div class="col-sm-6 col-lg-3 p-b-50">
					<h4 class="stext-301 cl0 p-b-30">
						連絡
					</h4>

					<p class="stext-107 cl7 size-201">
						〒263-0025 千葉市稲毛区穴川町386<br>Tel . 043-307-1819 / Fax . 043-307-6070
					</p>

					<div class="p-t-27">
						<a href="#" class="fs-18 cl7 hov-cl1 trans-04 m-r-16">
							<i class="fa fa-facebook"></i>
						</a>

						<a href="#" class="fs-18 cl7 hov-cl1 trans-04 m-r-16">
							<i class="fa fa-instagram"></i>
						</a>

						<a href="#" class="fs-18 cl7 hov-cl1 trans-04 m-r-16">
							<i class="fa fa-pinterest-p"></i>
						</a>
					</div>
				</div>

				<div class="col-sm-6 col-lg-3 p-b-50">
					<h4 class="stext-301 cl0 p-b-30">
						ニュースレーター
					</h4>

					<form>
						<div class="wrap-input1 w-full p-b-4">
							<input class="input1 bg-none plh1 stext-107 cl7" type="text" name="email"
								placeholder="email@example.com">
							<div class="focus-input1 trans-04"></div>
						</div>

						<div class="p-t-18">
							<button class="flex-c-m stext-101 cl0 size-103 bg1 bor1 hov-btn2 p-lr-15 trans-04">
								トップ
							</button>
						</div>
					</form>
				</div>
			</div>

			<div class="p-t-40">
				<div class="flex-c-m flex-w p-b-18">
					<a href="#" class="m-all-1">
						<img src="images/icons/icon-pay-01.png" alt="ICON-PAY">
					</a>

					<a href="#" class="m-all-1">
						<img src="images/icons/icon-pay-02.png" alt="ICON-PAY">
					</a>

					<a href="#" class="m-all-1">
						<img src="images/icons/icon-pay-03.png" alt="ICON-PAY">
					</a>

					<a href="#" class="m-all-1">
						<img src="images/icons/icon-pay-04.png" alt="ICON-PAY">
					</a>

					<a href="#" class="m-all-1">
						<img src="images/icons/icon-pay-05.png" alt="ICON-PAY">
					</a>
				</div>

				<!--<p class="stext-107 cl6 txt-center">
					Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0.
					-CIN &copy;
					<script>document.write(new Date().getFullYear());</script>
					Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0.

				</p>>
			</div>-->
			</div>
	</footer>

	<!-- Back to top -->
	<div class="btn-back-to-top" id="myBtn">
		<span class="symbol-btn-back-to-top">
			<i class="zmdi zmdi-chevron-up"></i>
		</span>
	</div>

	<!--===============================================================================================-->
	<script src="vendor/jquery/jquery-3.2.1.min.js"></script>
	<!--===============================================================================================-->
	<script src="vendor/animsition/js/animsition.min.js"></script>
	<!--===============================================================================================-->
	<script src="vendor/bootstrap/js/popper.js"></script>
	<script src="vendor/bootstrap/js/bootstrap.min.js"></script>
	<!--===============================================================================================-->
	<script src="vendor/select2/select2.min.js"></script>
	<script>
		$(".js-select2").each(function () {
			$(this).select2({
				minimumResultsForSearch: 20,
				dropdownParent: $(this).next('.dropDownSelect2')
			});
		})
	</script>
	<!--===============================================================================================-->
	<script src="vendor/MagnificPopup/jquery.magnific-popup.min.js"></script>
	<!--===============================================================================================-->
	<script src="vendor/perfect-scrollbar/perfect-scrollbar.min.js"></script>
	<script>
		$('.js-pscroll').each(function () {
			$(this).css('position', 'relative');
			$(this).css('overflow', 'hidden');
			var ps = new PerfectScrollbar(this, {
				wheelSpeed: 1,
				scrollingThreshold: 1000,
				wheelPropagation: false,
			});

			$(window).on('resize', function () {
				ps.update();
			})
		});
	</script>
	<!--===============================================================================================-->
	<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAKFWBqlKAGCeS1rMVoaNlwyayu0e0YRes"></script>
	<script src="js/map-custom.js"></script>
	<!--===============================================================================================-->
	<script src="js/main.js"></script>
	<!--========================================ここから追加したやつ==========================================-->
	<script th:inline="javascript">
		
		//ボタン制御
		var passwordCheck = false;	//パスワードが一致したらtrue
		var emailCheck = false;	//emailの検索結果が0件だったらtrue
		
		const firstName = document.getElementById('firstName');
		const lastName = document.getElementById('lastName');
		const phoneNumber = document.getElementById('phoneNumber');
		const postCode = document.getElementById('postCode');
		const firstAddress = document.getElementById('firstAddress');
		const lastAddress = document.getElementById('lastAddress');
		const button = document.getElementById('button_');
		
		//コントローラから受け取った値を変数に代入する。
		const firstNameValue = /*[[${firstNameValue}]]*/"firstNameValue";
		const lastNameValue = /*[[${lastNameValue}]]*/"lastNameValue";
		const phoneNumberValue = /*[[${phoneNumberValue}]]*/"phoneNumberValue";
		const postCodeValue = /*[[${postCodeValue}]]*/"postCodeValue";
		const firstAddressValue = /*[[${firstAddressValue}]]*/"firstAddressValue";
		const lastAddressValue = /*[[${lastAddressValue}]]*/"lastAddressValue";
		
		//emailの検索結果のフラグ
		const emailSearchResult = /*[[${emailSearchResult}]]*/"emailSearchResult";
		const errorMsg = document.getElementById("emailError_msg");
		
		//controllerから受け取った値をフォームの初期値にする。
		if (!firstNameValue == "")firstName.defaultValue = firstNameValue;
		if (!lastNameValue == "")lastName.defaultValue = lastNameValue;
		if (!phoneNumberValue == "")phoneNumber.defaultValue = phoneNumberValue;
		if (!postCodeValue == "")postCode.defaultValue = postCodeValue;
		if (!firstAddressValue == "")firstAddress.defaultValue = firstAddressValue;
		if (!lastAddressValue == "")lastAddress.defaultValue = lastAddressValue;
		
		//登録されているメールアドレスならエラー表示する。
		if (emailSearchResult == "true") {
			emailCheck = false;
			errorMsg.innerText = "このメールアドレスはすでに登録されています。";
			errorMsg.style.color = "red";
		}
		
		
		//新規登録画面ロードした瞬間にボタンを灰色にする
		window.addEventListener('load', (event) => {
  			button.style.backgroundColor = "gray";
		});
		
		
		//入力するたびにパスワード一致チェック
		function confirmPassword() {
  			const password = document.getElementById('password').value;
  			const confirmPassword = document.getElementById('rePassword').value;
            const errorMsg = document.getElementById('passwordError_msg');
            
            if (password != "") {
				if (password == confirmPassword) {
	                errorMsg.innerText = "";
	                passwordCheck = true;
	            } else {
	                errorMsg.innerText = "パスワードが一致しません";
	                passwordCheck = false;
	            }
			} else {
				errorMsg.innerText = "パスワードを入力してください";
				passwordCheck = false;
			}
			errorMsg.style.color = "red";
        }
        
        
        //入力するたびに必須項目のNULLチェック
		function nullCheck() {
			const email = document.getElementById('email').value;
			const password = document.getElementById('password').value;
			const rePassword = document.getElementById('rePassword').value;
			const firstName = document.getElementById('firstName').value;
			const lastName = document.getElementById('lastName').value;
			const phoneNumber = document.getElementById('phoneNumber').value;
			const postCode = document.getElementById('postCode').value;
			const firstAddress = document.getElementById('firstAddress').value;
			const lastAddress = document.getElementById('lastAddress').value;
			
			if(!email == "" && !password == "" && !rePassword == "" && !firstName == "" && !lastName == "" && 
               !phoneNumber == "" && !postCode == "" && !firstAddress == "" && !lastAddress == "" && passwordCheck == true && emailCheck == true) {
			    button.disabled = null;		//ボタンを押せるようにする。
			    button.style.backgroundColor = "black";
			} else {
				button.disabled = "disabled";	//ボタンを押せないようにする。
				button.style.backgroundColor = "gray";
			}
		}
		
		
		//emailの変更が行われたら、エラーメッセージを消す。
		function reInputEmail() {
			emailCheck = true;	
			errorMsg.innerText = "";
		}
	</script>
</body>
</html>